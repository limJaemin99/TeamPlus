<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.teamplus.mvc.dao.TeamTodoMapper">
    <!-- TodoNo 만들기 위한 시퀀스 추출-->
    <select id="getSequence" resultType="int">
        select
            teamTodoNo_seq.nextval
        from
            dual
    </select>

    <!-- 프로젝트-할일리스트 등록(insert문)-->
    <insert id="insert">
        insert
        into
            TeamTodo(TodoNO,ProjectNo,UserNO,Title,Description,TodoDate,DueDate)
        values
            (#{todoNo},#{projectNo},#{userNO},#{title},#{description},#{todoDate},#{dueDate})

    </insert>

    <!-- 프로젝트-할일리스트 진행상태 설정하는 update문 (파라미터 타입 : Map<String,object> _ -->
    <!--
    예시)
    Map<String,Objec> map = new HashMap<>();
    map.put("status",1);
    map.put("todoNo","프로젝트명_유저아이디_1");
    setStatus(map);
    -->
    <update id="setStatus">
        update TeamTodo
        set
            Status=#{status}
        where
            TodoNo=#{todoNO}
    </update>

    <!-- TeamTodo에서 할일리스트 내용 수정하는 update문-->
    <update id="update">
        update TeamTodo
        set
            Title=#{title},
            Description=#{description},
            TodoDate=#{todoDate},
            DueDate=#{dueDate}
        where
            TodoNo=#{todoNo}
    </update>

    <!-- 할일 완료 설정 update문-->
    <!-- 시작전 : 0(기본값) / 진행중 : 1 / 완료 : 2 로 기준 -->
    <update id="setComplete">
        update TeamTodo
        set
            EndDate=sysdate,
            Status=2
        where
            TodoNO=#{todoNO}
    </update>

    <!-- TodoNo으로 TeamTodo에서 삭제하는 delete문-->
    <delete id="delete">
        delete
        from TeamTodo
        where TodoNo=#{todoNO}
    </delete>

    <!-- TeamTodo 전체 조회-->
    <select id="selectAll" resultType="TeamTodoDTO">
        select * from TeamTodo
    </select>

    <!-- ProjectNo 와 UserNo별 조회-->
    <select id="selectByuserNO" resultType="TeamTodoDTO">
        select *
        from TeamTodo
        where
            ProjectNo=#{projectNo} AND UserNo=#{userNO}
    </select>

    <!-- 할일 상태별 조회-->
    <select id="selectByStatus" resultType="TeamTodoDTO">
        select *
        from TeamTodo
        where
            Status=#{status}
    </select>

    <!-- 종료 예정일별 조회? (필요 시 추가)-->


</mapper>